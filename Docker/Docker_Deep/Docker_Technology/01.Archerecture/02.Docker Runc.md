## What is runc?
**runc**¬†is a lightweight, portable container runtime written in Go. It's the underlying tool that actually creates and runs containers according to the Open Container Initiative (OCI) specification.

# How runc Creates and Runs a Container - A Story üé¨

Let me tell you a story about how runc creates a container. Imagine you're building a **magic room** inside your house...

## The Story of Building a Magic Room ‚ú®

You have a **big house** (your computer) and you want to create a **magic room** (a container) where everything inside is separate from the rest of the house.

### Step 1: Getting the Blueprint (The OCI Bundle)

First, Docker prepares a **blueprint package** for runc. This package has:

1. **A picture of the room's interior** (root filesystem) - This is like all the furniture and decorations that should be in the room
2. **An instruction manual** (config.json) - This tells exactly how to build the room:
   - How big the room should be
   - What doors it should have
   - What the room can and cannot touch in the house

Think of it like ordering a "Room Kit" from IKEA. Docker gets all the pieces ready and gives them to runc.

### Step 2: Building the Walls (Creating Namespaces)

Now runc starts building. First, it puts up **invisible walls** around the room. These are called **namespaces**. There are 6 types of walls:

1. **PID Wall** - People inside can only see other people in the same room
2. **Network Wall** - The room gets its own phone line and internet connection
3. **Filesystem Wall** - The room has its own floor and cabinets
4. **UTS Wall** - The room can have its own name, different from the house
5. **IPC Wall** - Messages can't pass through the walls
6. **User Wall** - People inside might have different IDs than outside

It's like putting up special glass that's see-through from outside but mirrors from inside - you can look into the room, but the room can't look out!

### Step 3: Setting House Rules (cgroups)

Next, runc sets the **house rules** for the room. These rules say:

- "This room can only use 512MB of memory"
- "This room can only use 2 CPUs"
- "This room can only have 10GB of storage space"

These rules are called **cgroups** (control groups). They're like putting a meter on the room's electricity and water supply.

### Step 4: Security Measures (Capabilities & seccomp)

Now runc adds security:

1. **Capabilities** - Takes away most of the room's "superpowers"
   - The room CAN change its own lightbulbs
   - The room CANNOT rewire the house's electricity
   - The room CANNOT knock down walls

2. **seccomp** - Blocks certain "phone calls" the room might try to make
   - "You can call the plumber"
   - "You cannot call the demolition crew"

### Step 5: Moving In the Furniture (Mounting Filesystem)

Now runc unpacks the furniture! It takes the **root filesystem** (that picture of the room's interior) and puts it inside the room:

- Creates /bin, /etc, /home directories
- Puts programs like `ls`, `bash`, `nginx` in their places
- Sets up the room's own little world

But here's the magic: runc uses a **union filesystem** (like OverlayFS). This is like having:
- A **base layer** (the floor and walls everyone uses)
- A **writing layer** (this room's special decorations)
- When you look at the room, you see them combined!

### Step 6: Starting Life in the Room (Running the Process)

Finally, runc starts the **main process** inside the room. This is like turning on the room's main light and starting its life:

1. **The door opens** (process starts)
2. **The room comes alive** (program begins running)
3. **The room starts doing its job** (like serving web pages if it's nginx)

The first process that starts is usually called **PID 1** inside the room. It's like the mayor of this little town. If the mayor leaves, the town disappears!

### Step 7: The Room is Now Living!

The magic room is now:
- ‚úÖ Living independently
- ‚úÖ Following all the rules
- ‚úÖ Can't see the rest of the house
- ‚úÖ Has its own little world
- ‚úÖ Doing its specific job

## What Happens When You Run `docker run nginx`?

Let's watch the magic happen in slow motion:

```
You type: docker run nginx
           ‚Üì
Docker thinks: "OK, user wants nginx!"
           ‚Üì
Docker checks: "Do I have nginx image? Yes!"
           ‚Üì
Docker tells runc: "Here's the blueprint for an nginx room"
           ‚Üì
runc starts building: "Building walls... setting rules..."
           ‚Üì
runc creates the magic room with nginx inside
           ‚Üì
nginx starts up in its own little world
           ‚Üì
The room is now serving web pages!
```

## The Magic Trick Revealed üé©

The real magic is that **all these "rooms" share the same house foundation** (the Linux kernel). It's like having 100 apartments in a building - they all share the same foundation, plumbing, and electricity infrastructure, but each apartment is completely private!

## A Simple Example You Can Almost See:

```bash
# When you run this:
docker run -d --name webserver -p 80:80 nginx

# Here's what runc does in simple terms:

# 1. Takes the nginx "room blueprint"
# 2. Puts up invisible walls around a space
# 3. Sets rules: "You get 2 CPUs and 1GB memory"
# 4. Takes away dangerous powers
# 5. Puts nginx program inside
# 6. Creates a "mail slot" (port 80) so people can send requests
# 7. Starts nginx
# 8. Closes the door (but leaves the mail slot open)

# Now nginx lives in its own little world,
# serving web pages through the mail slot!
```

## Why This is Better Than Virtual Machines:

With virtual machines, it's like building **entire separate houses** next to your house. Each has its own foundation, plumbing, electricity - everything duplicated!

With containers (using runc), it's like adding **magic rooms** to your existing house. They share the foundation but are completely separate spaces. Much faster to build, much less waste!

## The Beautiful Part:

The most beautiful part is that **you don't see any of this complexity!** You just type `docker run` and poof! A perfect little isolated environment appears, does its job, and disappears when you're done.

It's like having a magic genie that builds perfect little self-contained worlds whenever you ask! üßû‚ôÇÔ∏è

That's how runc creates and runs containers - by building these amazing, isolated, rule-following magic rooms inside your computer!